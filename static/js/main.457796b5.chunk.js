(this["webpackJsonpchess-app"]=this["webpackJsonpchess-app"]||[]).push([[0],{18:function(e,n,i){},19:function(e,n,i){},20:function(e,n,i){},21:function(e,n,i){},23:function(e,n,i){"use strict";i.r(n);var t=i(1),o=i.n(t),s=i(11),r=i.n(s),a=(i(18),i(19),i(7)),c=i(10),u=i(2),f=i(3),p=i(4),l=function(e){return e.PAWN="pawn",e.BISHOP="bishop",e.KNIGHT="knight",e.ROOK="rook",e.QUEEN="queen",e.KING="king",e}({}),v=function(e){return e.OPPONENT="b",e.OUR="w",e}({}),h=function(){function e(n,i,t,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];Object(f.a)(this,e),this.image=void 0,this.position=void 0,this.type=void 0,this.team=void 0,this.possibleMoves=void 0,this.hasMoved=void 0,this.image="assets/images/".concat(i,"_").concat(t,".png"),this.position=n,this.type=i,this.team=t,this.possibleMoves=s,this.hasMoved=o}return Object(p.a)(e,[{key:"isPawn",get:function(){return this.type===l.PAWN}},{key:"isRook",get:function(){return this.type===l.ROOK}},{key:"isKnight",get:function(){return this.type===l.KNIGHT}},{key:"isBishop",get:function(){return this.type===l.BISHOP}},{key:"isKing",get:function(){return this.type===l.KING}},{key:"isQueen",get:function(){return this.type===l.QUEEN}},{key:"samePiecePosition",value:function(e){return this.position.samePosition(e.position)}},{key:"samePosition",value:function(e){return this.position.samePosition(e)}},{key:"clone",value:function(){var n;return new e(this.position.clone(),this.type,this.team,this.hasMoved,null===(n=this.possibleMoves)||void 0===n?void 0:n.map((function(e){return e.clone()})))}}]),e}(),b=function(){function e(n,i){Object(f.a)(this,e),this.x=void 0,this.y=void 0,this.x=n,this.y=i}return Object(p.a)(e,[{key:"samePosition",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"clone",value:function(){return new e(this.x,this.y)}}]),e}(),O=function(e,n){return!!n.find((function(n){return n.samePosition(e)}))},m=function(e,n,i){return!!n.find((function(n){return n.samePosition(e)&&n.team!==i}))},y=function(e,n,i){return!O(e,n)||m(e,n,i)},d=function(e,n){var i=[];if(e.hasMoved)return i;var t,o=n.filter((function(n){return n.isRook&&n.team===e.team&&!n.hasMoved})),s=Object(u.a)(o);try{var r=function(){var o,s=t.value,r=s.position.x-e.position.x>0?1:-1,a=e.position.clone();if(a.x+=r,null===(o=s.possibleMoves)||void 0===o||!o.some((function(e){return e.samePosition(a)})))return"continue";var c,f=s.possibleMoves.filter((function(n){return n.y===e.position.y})),p=n.filter((function(n){return n.team!==e.team})),l=!0,v=Object(u.a)(p);try{for(v.s();!(c=v.n()).done;){var h=c.value;if(void 0!==h.possibleMoves){var b,O=Object(u.a)(h.possibleMoves);try{var m=function(){var e=b.value;if(f.some((function(n){return n.samePosition(e)}))&&(l=!1),!l)return"break"};for(O.s();!(b=O.n()).done;){if("break"===m())break}}catch(y){O.e(y)}finally{O.f()}if(!l)break}}}catch(y){v.e(y)}finally{v.f()}if(!l)return"continue";i.push(s.position.clone())};for(s.s();!(t=s.n()).done;)r()}catch(a){s.e(a)}finally{s.f()}return i},w=function(){function e(n,i){Object(f.a)(this,e),this.pieces=void 0,this.totalTurns=void 0,this.winningTeam=void 0,this.pieces=n,this.totalTurns=i}return Object(p.a)(e,[{key:"currentTeam",get:function(){return this.totalTurns%2===0?v.OPPONENT:v.OUR}},{key:"calculateAllMoves",value:function(){var e,n=this,i=Object(u.a)(this.pieces);try{for(i.s();!(e=i.n()).done;){var t=e.value;t.possibleMoves=this.getValidMoves(t,this.pieces)}}catch(p){i.e(p)}finally{i.f()}var o,s=Object(u.a)(this.pieces.filter((function(e){return e.isKing})));try{for(s.s();!(o=s.n()).done;){var r=o.value;void 0!==r.possibleMoves&&(r.possibleMoves=[].concat(Object(c.a)(r.possibleMoves),Object(c.a)(d(r,this.pieces))))}}catch(p){s.e(p)}finally{s.f()}this.checkCurrentTeamMoves();var a,f=Object(u.a)(this.pieces.filter((function(e){return e.team!==n.currentTeam})));try{for(f.s();!(a=f.n()).done;){a.value.possibleMoves=[]}}catch(p){f.e(p)}finally{f.f()}this.pieces.filter((function(e){return e.team===n.currentTeam})).some((function(e){return void 0!==e.possibleMoves&&e.possibleMoves.length>0}))||(this.winningTeam=this.currentTeam===v.OUR?v.OPPONENT:v.OUR)}},{key:"checkCurrentTeamMoves",value:function(){var e,n=this,i=Object(u.a)(this.pieces.filter((function(e){return e.team===n.currentTeam})));try{var t=function(){var i=e.value;if(void 0===i.possibleMoves)return"continue";var t,o=Object(u.a)(i.possibleMoves);try{var s=function(){var e=t.value,o=n.clone();o.pieces=o.pieces.filter((function(n){return!n.samePosition(e)})),o.pieces.find((function(e){return e.samePiecePosition(i)})).position=e.clone();var s,r=o.pieces.find((function(e){return e.isKing&&e.team===o.currentTeam})),a=Object(u.a)(o.pieces.filter((function(e){return e.team!==o.currentTeam})));try{var c=function(){var n,t,a=s.value;(a.possibleMoves=o.getValidMoves(a,o.pieces),a.isPawn)?a.possibleMoves.some((function(e){return e.x!==a.position.x&&e.samePosition(r.position)}))&&(i.possibleMoves=null===(n=i.possibleMoves)||void 0===n?void 0:n.filter((function(n){return!n.samePosition(e)}))):a.possibleMoves.some((function(e){return e.samePosition(r.position)}))&&(i.possibleMoves=null===(t=i.possibleMoves)||void 0===t?void 0:t.filter((function(n){return!n.samePosition(e)})))};for(a.s();!(s=a.n()).done;)c()}catch(f){a.e(f)}finally{a.f()}};for(o.s();!(t=o.n()).done;)s()}catch(r){o.e(r)}finally{o.f()}};for(i.s();!(e=i.n()).done;)t()}catch(o){i.e(o)}finally{i.f()}}},{key:"getValidMoves",value:function(e,n){switch(e.type){case l.PAWN:return function(e,n){var i=[],t=e.team===v.OUR?1:6,o=e.team===v.OUR?1:-1,s=new b(e.position.x,e.position.y+o),r=new b(s.x,s.y+o),a=new b(e.position.x-1,e.position.y+o),c=new b(e.position.x+1,e.position.y+o),u=new b(e.position.x-1,e.position.y),f=new b(e.position.x+1,e.position.y);if(O(s,n)||(i.push(s),e.position.y!==t||O(r,n)||i.push(r)),m(a,n,e.team))i.push(a);else if(!O(a,n)){var p=n.find((function(e){return e.samePosition(u)}));null!=p&&p.enPassant&&i.push(a)}if(m(c,n,e.team))i.push(c);else if(!O(c,n)){var l=n.find((function(e){return e.samePosition(f)}));null!=l&&l.enPassant&&i.push(c)}return i}(e,n);case l.KNIGHT:return function(e,n){for(var i=[],t=-1;t<2;t+=2)for(var o=-1;o<2;o+=2){var s=new b(e.position.x+o,e.position.y+2*t),r=new b(e.position.x+2*t,e.position.y+o);y(s,n,e.team)&&i.push(s),y(r,n,e.team)&&i.push(r)}return i}(e,n);case l.BISHOP:return function(e,n){for(var i=[],t=1;t<8;t++){var o=new b(e.position.x+t,e.position.y+t);if(O(o,n)){if(m(o,n,e.team)){i.push(o);break}break}i.push(o)}for(var s=1;s<8;s++){var r=new b(e.position.x+s,e.position.y-s);if(O(r,n)){if(m(r,n,e.team)){i.push(r);break}break}i.push(r)}for(var a=1;a<8;a++){var c=new b(e.position.x-a,e.position.y-a);if(O(c,n)){if(m(c,n,e.team)){i.push(c);break}break}i.push(c)}for(var u=1;u<8;u++){var f=new b(e.position.x-u,e.position.y+u);if(O(f,n)){if(m(f,n,e.team)){i.push(f);break}break}i.push(f)}return i}(e,n);case l.ROOK:return function(e,n){for(var i=[],t=1;t<8&&!(e.position.y+t>7);t++){var o=new b(e.position.x,e.position.y+t);if(O(o,n)){if(m(o,n,e.team)){i.push(o);break}break}i.push(o)}for(var s=1;s<8&&!(e.position.y-s<0);s++){var r=new b(e.position.x,e.position.y-s);if(O(r,n)){if(m(r,n,e.team)){i.push(r);break}break}i.push(r)}for(var a=1;a<8&&!(e.position.x-a<0);a++){var c=new b(e.position.x-a,e.position.y);if(O(c,n)){if(m(c,n,e.team)){i.push(c);break}break}i.push(c)}for(var u=1;u<8&&!(e.position.x+u>7);u++){var f=new b(e.position.x+u,e.position.y);if(O(f,n)){if(m(f,n,e.team)){i.push(f);break}break}i.push(f)}return i}(e,n);case l.QUEEN:return function(e,n){for(var i=[],t=1;t<8;t++){var o=new b(e.position.x,e.position.y+t);if(O(o,n)){if(m(o,n,e.team)){i.push(o);break}break}i.push(o)}for(var s=1;s<8;s++){var r=new b(e.position.x,e.position.y-s);if(O(r,n)){if(m(r,n,e.team)){i.push(r);break}break}i.push(r)}for(var a=1;a<8;a++){var c=new b(e.position.x-a,e.position.y);if(O(c,n)){if(m(c,n,e.team)){i.push(c);break}break}i.push(c)}for(var u=1;u<8;u++){var f=new b(e.position.x+u,e.position.y);if(O(f,n)){if(m(f,n,e.team)){i.push(f);break}break}i.push(f)}for(var p=1;p<8;p++){var l=new b(e.position.x+p,e.position.y+p);if(O(l,n)){if(m(l,n,e.team)){i.push(l);break}break}i.push(l)}for(var v=1;v<8;v++){var h=new b(e.position.x+v,e.position.y-v);if(O(h,n)){if(m(h,n,e.team)){i.push(h);break}break}i.push(h)}for(var y=1;y<8;y++){var d=new b(e.position.x-y,e.position.y-y);if(O(d,n)){if(m(d,n,e.team)){i.push(d);break}break}i.push(d)}for(var w=1;w<8;w++){var P=new b(e.position.x-w,e.position.y+w);if(O(P,n)){if(m(P,n,e.team)){i.push(P);break}break}i.push(P)}return i}(e,n);case l.KING:return function(e,n){for(var i=[],t=1;t<2;t++){var o=new b(e.position.x,e.position.y+t);if(o.x<0||o.x>7||o.y<0||o.y>7)break;if(O(o,n)){if(m(o,n,e.team)){i.push(o);break}break}i.push(o)}for(var s=1;s<2;s++){var r=new b(e.position.x,e.position.y-s);if(r.x<0||r.x>7||r.y<0||r.y>7)break;if(O(r,n)){if(m(r,n,e.team)){i.push(r);break}break}i.push(r)}for(var a=1;a<2;a++){var c=new b(e.position.x-a,e.position.y);if(c.x<0||c.x>7||c.y<0||c.y>7)break;if(O(c,n)){if(m(c,n,e.team)){i.push(c);break}break}i.push(c)}for(var u=1;u<2;u++){var f=new b(e.position.x+u,e.position.y);if(f.x<0||f.x>7||f.y<0||f.y>7)break;if(O(f,n)){if(m(f,n,e.team)){i.push(f);break}break}i.push(f)}for(var p=1;p<2;p++){var l=new b(e.position.x+p,e.position.y+p);if(l.x<0||l.x>7||l.y<0||l.y>7)break;if(O(l,n)){if(m(l,n,e.team)){i.push(l);break}break}i.push(l)}for(var v=1;v<2;v++){var h=new b(e.position.x+v,e.position.y-v);if(h.x<0||h.x>7||h.y<0||h.y>7)break;if(O(h,n)){if(m(h,n,e.team)){i.push(h);break}break}i.push(h)}for(var y=1;y<2;y++){var d=new b(e.position.x-y,e.position.y-y);if(d.x<0||d.x>7||d.y<0||d.y>7)break;if(O(d,n)){if(m(d,n,e.team)){i.push(d);break}break}i.push(d)}for(var w=1;w<2;w++){var P=new b(e.position.x-w,e.position.y+w);if(P.x<0||P.x>7||P.y<0||P.y>7)break;if(O(P,n)){if(m(P,n,e.team)){i.push(P);break}break}i.push(P)}return i}(e,n);default:return[]}}},{key:"playMove",value:function(e,n,i,t){var o=i.team===v.OUR?1:-1,s=this.pieces.find((function(e){return e.samePosition(t)}));if(i.isKing&&null!==s&&void 0!==s&&s.isRook&&s.team===i.team){var r=s.position.x-i.position.x>0?1:-1,a=i.position.x+2*r;return this.pieces=this.pieces.map((function(e){return e.samePiecePosition(i)?e.position.x=a:e.samePiecePosition(s)&&(e.position.x=a-r),e})),this.calculateAllMoves(),!0}if(e)this.pieces=this.pieces.reduce((function(e,n){return n.samePiecePosition(i)?(n.isPawn&&(n.enPassant=!1),n.position.x=t.x,n.position.y=t.y,n.hasMoved=!0,e.push(n)):n.samePosition(new b(t.x,t.y-o))||(n.isPawn&&(n.enPassant=!1),e.push(n)),e}),[]),this.calculateAllMoves();else{if(!n)return!1;this.pieces=this.pieces.reduce((function(e,n){return n.samePiecePosition(i)?(n.isPawn&&(n.enPassant=2===Math.abs(i.position.y-t.y)&&n.type===l.PAWN),n.position.x=t.x,n.position.y=t.y,n.hasMoved=!0,e.push(n)):n.samePosition(t)||(n.isPawn&&(n.enPassant=!1),e.push(n)),e}),[]),this.calculateAllMoves()}return!0}},{key:"clone",value:function(){return new e(this.pieces.map((function(e){return e.clone()})),this.totalTurns)}}]),e}(),P=i(13),x=i(12),k=function(e){Object(P.a)(i,e);var n=Object(x.a)(i);function i(e,t,o,s){var r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Object(f.a)(this,i),(r=n.call(this,e,l.PAWN,t,o,a)).enPassant=void 0,r.enPassant=s,r}return Object(p.a)(i,[{key:"clone",value:function(){var e;return new i(this.position.clone(),this.team,this.hasMoved,this.enPassant,null===(e=this.possibleMoves)||void 0===e?void 0:e.map((function(e){return e.clone()})))}}]),i}(h),j=["1","2","3","4","5","6","7","8"],N=["a","b","c","d","e","f","g","h"],g=100,M=new w([new h(new b(0,7),l.ROOK,v.OPPONENT,!1),new h(new b(1,7),l.KNIGHT,v.OPPONENT,!1),new h(new b(2,7),l.BISHOP,v.OPPONENT,!1),new h(new b(3,7),l.QUEEN,v.OPPONENT,!1),new h(new b(4,7),l.KING,v.OPPONENT,!1),new h(new b(5,7),l.BISHOP,v.OPPONENT,!1),new h(new b(6,7),l.KNIGHT,v.OPPONENT,!1),new h(new b(7,7),l.ROOK,v.OPPONENT,!1),new k(new b(0,6),v.OPPONENT,!1),new k(new b(1,6),v.OPPONENT,!1),new k(new b(2,6),v.OPPONENT,!1),new k(new b(3,6),v.OPPONENT,!1),new k(new b(4,6),v.OPPONENT,!1),new k(new b(5,6),v.OPPONENT,!1),new k(new b(6,6),v.OPPONENT,!1),new k(new b(7,6),v.OPPONENT,!1),new h(new b(0,0),l.ROOK,v.OUR,!1),new h(new b(1,0),l.KNIGHT,v.OUR,!1),new h(new b(2,0),l.BISHOP,v.OUR,!1),new h(new b(3,0),l.QUEEN,v.OUR,!1),new h(new b(4,0),l.KING,v.OUR,!1),new h(new b(5,0),l.BISHOP,v.OUR,!1),new h(new b(6,0),l.KNIGHT,v.OUR,!1),new h(new b(7,0),l.ROOK,v.OUR,!1),new k(new b(0,1),v.OUR,!1),new k(new b(1,1),v.OUR,!1),new k(new b(2,1),v.OUR,!1),new k(new b(3,1),v.OUR,!1),new k(new b(4,1),v.OUR,!1),new k(new b(5,1),v.OUR,!1),new k(new b(6,1),v.OUR,!1),new k(new b(7,1),v.OUR,!1)],1);M.calculateAllMoves();i(20),i(21);var T=i(0);function R(e){var n=e.number,i=e.image,t=["tile",n%2===0&&"black-tile",n%2!==0&&"white-tile",e.highlight&&"tile-highlight",i&&"chess-piece-tile"].filter(Boolean).join(" ");return Object(T.jsx)("div",{className:t,children:i&&Object(T.jsx)("div",{style:{backgroundImage:"url(".concat(i,")")},className:"chess-piece"})})}function U(e){var n=e.playMove,i=e.pieces,o=Object(t.useState)(null),s=Object(a.a)(o,2),r=s[0],c=s[1],u=Object(t.useState)(new b(-1,-1)),f=Object(a.a)(u,2),p=f[0],l=f[1],v=Object(t.useRef)(null);for(var h=[],O=function(e){for(var n=function(n){var t=e+n+2,o=i.find((function(i){return i.samePosition(new b(n,e))})),s=o?o.image:void 0,a=null!=r?i.find((function(e){return e.samePosition(p)})):void 0,c=!(null===a||void 0===a||!a.possibleMoves)&&a.possibleMoves.some((function(i){return i.samePosition(new b(n,e))}));h.push(Object(T.jsx)(R,{image:s,number:t,highlight:c},"".concat(e,",").concat(n)))},t=0;t<N.length;t++)n(t)},m=j.length-1;m>=0;m--)O(m);return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)("div",{onMouseMove:function(e){return function(e){var n=v.current;if(r&&n){var i=n.offsetLeft-25,t=n.offsetTop-25,o=n.offsetLeft+n.clientWidth-75,s=n.offsetTop+n.clientHeight-75,a=e.clientX-50,c=e.clientY-50;r.style.position="absolute",r.style.left="".concat(a<i?i:a>o?o:a,"px"),r.style.top="".concat(c<t?t:c>s?s:c,"px")}}(e)},onMouseDown:function(e){return function(e){var n=e.target,i=v.current;if(n.classList.contains("chess-piece")&&i){var t=Math.floor((e.clientX-i.offsetLeft)/g),o=Math.abs(Math.ceil((e.clientY-i.offsetTop-800)/g));l(new b(t,o));var s=e.clientX-g/2,r=e.clientY-g/2;n.style.position="absolute",n.style.left="".concat(s,"px"),n.style.top="".concat(r,"px"),c(n)}}(e)},onMouseUp:function(e){return function(e){var t=v.current;if(r&&t){var o=Math.floor((e.clientX-t.offsetLeft)/g),s=Math.abs(Math.ceil((e.clientY-t.offsetTop-800)/g)),a=i.find((function(e){return e.samePosition(p)}));a&&(n(a.clone(),new b(o,s))||(r.style.position="relative",r.style.removeProperty("top"),r.style.removeProperty("left"))),c(null)}}(e)},id:"chessboard",ref:v,children:h})})}function E(){var e=Object(t.useState)(M.clone()),n=Object(a.a)(e,2),i=n[0],o=n[1],s=Object(t.useState)(),r=Object(a.a)(s,2),c=r[0],u=r[1],f=Object(t.useRef)(null),p=Object(t.useRef)(null);function b(e){var n;void 0!==c&&(o((function(n){var t=i.clone();return t.pieces=t.pieces.reduce((function(n,i){return i.samePiecePosition(c)?n.push(new h(i.position.clone(),e,i.team,!0)):n.push(i),n}),[]),t.calculateAllMoves(),t})),null===(n=f.current)||void 0===n||n.classList.add("hidden"))}function O(){return(null===c||void 0===c?void 0:c.team)===v.OUR?"w":"b"}return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("p",{style:{color:"white",fontSize:"24px",textAlign:"center"},children:["Total turns: ",i.totalTurns]}),Object(T.jsx)("div",{className:"modal hidden",ref:f,children:Object(T.jsxs)("div",{className:"modal-body",children:[Object(T.jsx)("img",{onClick:function(){return b(l.ROOK)},src:"/assets/images/rook_".concat(O(),".png")}),Object(T.jsx)("img",{onClick:function(){return b(l.BISHOP)},src:"/assets/images/bishop_".concat(O(),".png")}),Object(T.jsx)("img",{onClick:function(){return b(l.KNIGHT)},src:"/assets/images/knight_".concat(O(),".png")}),Object(T.jsx)("img",{onClick:function(){return b(l.QUEEN)},src:"/assets/images/queen_".concat(O(),".png")})]})}),Object(T.jsx)("div",{className:"modal hidden",ref:p,children:Object(T.jsx)("div",{className:"modal-body",children:Object(T.jsxs)("div",{className:"checkmate-body",children:[Object(T.jsxs)("span",{children:["The winning team is ",i.winningTeam===v.OUR?"white":"black","!"]}),Object(T.jsx)("button",{onClick:function(){var e;null===(e=p.current)||void 0===e||e.classList.add("hidden"),o(M.clone())},children:"Play again"})]})})}),Object(T.jsx)(U,{playMove:function(e,n){var t;if(void 0===e.possibleMoves)return!1;if(e.team===v.OUR&&i.totalTurns%2!==1)return!1;if(e.team===v.OPPONENT&&i.totalTurns%2!==0)return!1;var s=!1,r=null===(t=e.possibleMoves)||void 0===t?void 0:t.some((function(e){return e.samePosition(n)}));if(!r)return!1;var a=function(e,n,t,o){var s=o===v.OUR?1:-1;if(t===l.PAWN){if((n.x-e.x===-1||n.x-e.x===1)&&n.y-e.y===s)if(i.pieces.find((function(e){return e.position.x===n.x&&e.position.y===n.y-s&&e.isPawn&&e.enPassant})))return!0}return!1}(e.position,n,e.type,e.team);o((function(){var t,o=i.clone();(o.totalTurns+=1,s=o.playMove(a,r,e,n),void 0!==o.winningTeam)&&(null===(t=p.current)||void 0===t||t.classList.remove("hidden"));return o}));var c,h=e.team===v.OUR?7:0;return n.y===h&&e.isPawn&&(null===(c=f.current)||void 0===c||c.classList.remove("hidden"),u((function(i){var t=e.clone();return t.position=n.clone(),t}))),s},pieces:i.pieces})]})}var K=function(){return Object(T.jsx)("div",{id:"app",children:Object(T.jsx)(E,{})})},I=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,24)).then((function(n){var i=n.getCLS,t=n.getFID,o=n.getFCP,s=n.getLCP,r=n.getTTFB;i(e),t(e),o(e),s(e),r(e)}))};r.a.render(Object(T.jsx)(o.a.StrictMode,{children:Object(T.jsx)(K,{})}),document.getElementById("root")),I()}},[[23,1,2]]]);
//# sourceMappingURL=main.457796b5.chunk.js.map